function NotifyLineGroupTomorrow() {
  var calendarIds = {
    'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX': 'ü•∞‡∏ú‡∏≠.‡∏®‡∏ó‡∏™.ü•∞',
    'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX': '‚ò¢Ô∏è‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‚ò¢Ô∏è',
    'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX': 'üë©‚Äçüöí‡∏Å‡∏•‡∏∏‡πà‡∏° ‡∏Å‡∏ó‡∏™.üë©‚Äçüöí',
    'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX': 'ü¶ñ‡∏Å‡∏•‡∏∏‡πà‡∏° ‡∏Å‡∏û‡∏™.ü¶ñ',
    'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX': 'üêû‡∏Å‡∏•‡∏∏‡πà‡∏° ‡∏Å‡∏ß‡∏Ç.üêû'
  }; // Calendar ID

  var token = "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"; // Line Token 
  var url = "https://notify-api.line.me/api/notify";
  
  var tomorrow = new Date(new Date().getFullYear(), new Date().getMonth(), new Date().getDate() + 1);
  
  for (var calendarId in calendarIds) {
    var calendar = CalendarApp.getCalendarById(calendarId);
    var events = calendar.getEventsForDay(tomorrow);
    
    if (events.length === 0) {
      var msg = "\n‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á" + calendarIds[calendarId] + " (‡∏ß‡∏±‡∏ô‡∏û‡∏£‡∏∏‡πà‡∏á‡∏ô‡∏µ‡πâ)\n"+ formatDateTomorrow(tomorrow) +"\n(‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°)";
    } else {
      var msg = "\n‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á" + calendarIds[calendarId] + " (‡∏ß‡∏±‡∏ô‡∏û‡∏£‡∏∏‡πà‡∏á‡∏ô‡∏µ‡πâ)\n" + formatDateTomorrow(tomorrow) + "\n‡∏°‡∏µ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î " + String(events.length) + " ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° ‡πÑ‡∏î‡πâ‡πÅ‡∏Å‡πà";
      msg += sendMessageTomorrow(events);
    }
    
    var jsonData = {
      message: msg
    }
    var options =
    {
      "method": "post",
      "contentType": "application/x-www-form-urlencoded",
      "payload": jsonData,
      "headers": { "Authorization": "Bearer " + token }
    };
    var res = UrlFetchApp.fetch(url, options);
  }
}

function sendMessageTomorrow(events) {
  var msg = "";
  events.forEach(function (event, index) {
    var title = event.getTitle();
    var start = event.isAllDayEvent() ? "‡∏ó‡∏±‡πâ‡∏á‡∏ß‡∏±‡∏ô" : event.getStartTime().getHours() + ":" + ("0" + event.getStartTime().getMinutes()).slice(-2);
    var end = event.isAllDayEvent() ? "" : " - " + event.getEndTime().getHours() + ":" + ("0" + event.getEndTime().getMinutes()).slice(-2) + " ‡∏ô.";
    var description = event.getDescription();
    var location = event.getLocation();
    
    msg += "\n\n‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà " + (index + 1) + "\n‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á : " + title + "\n‡πÄ‡∏ß‡∏•‡∏≤ : " + start + end + "\n‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î : " + description + "\n‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà : " + location;
  });
  return msg;
}

function formatDateTomorrow(date) {
  var dayOfWeek = ["‡∏ß‡∏±‡∏ô‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå", "‡∏ß‡∏±‡∏ô‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå", "‡∏ß‡∏±‡∏ô‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£", "‡∏ß‡∏±‡∏ô‡∏û‡∏∏‡∏ò", "‡∏ß‡∏±‡∏ô‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ", "‡∏ß‡∏±‡∏ô‡∏®‡∏∏‡∏Å‡∏£‡πå", "‡∏ß‡∏±‡∏ô‡πÄ‡∏™‡∏≤‡∏£‡πå"];
  var monthOfYear = ["‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°", "‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå", "‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°", "‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô", "‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°", "‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô", "‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°", "‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°", "‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô", "‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°", "‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô", "‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°"];
  
  var day = date.getDate();
  var month = monthOfYear[date.getMonth()];
  var year = date.getFullYear() + 543; // ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô ‡∏û.‡∏®.
  var dayIndex = date.getDay();
  var dayName = dayOfWeek[dayIndex];
  
  return dayName + "‡∏ó‡∏µ‡πà " + day + " " + month + " " + year;
}
